# Solution 2 - nojumpstarts

*EURECOM - Yavuz AKIN - 23 January 2022*

## Description of the problem

The nojumpstarts APK is composed of 4 principal activities : the Main Activity, A, B, and C. There is also an activity named main for operations (building intent, signing messages, ...)

In order to get the flag, the Main Activity start the activity A through and waits for a response. Inside this intent there an authentification message and a signature. 

A checks if the authentification message and signatures are correct and then it asks B for the flag the same way the Main Activity did.

B checks the intent of A similarly to before, and asks similarly to C for the flag.

After C checks B's message it sends the flag to B, B sends it to A, and A to the Main Activity.

The goal here is to retrieve this flag by jump starting C.

## Solution

In simple words, we create an activity that passes for B and we start C through an intent. 

A problem is that C checks through the authetification message that the request has past through the Main Activity to A to B and through signing that the message has been signed by B. 

By reversing the apk we can have access to both the authentification messages put in place by the Main Activity, A, and B, but also to the signature algorithm and keys used for it. 

For instance the authentification message would be :

"Main-to-A/A-to-B/B-to-C";

Then through this new activity we send a start intent to C. C checks out our authentification message and signature which are correct and assumes the order has been coming through the Main Activity, A and B and sends back the flag as a reply.


## Optional Feedback